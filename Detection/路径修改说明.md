# Detection æ–‡ä»¶å¤¹è·¯å¾„ä¿®æ”¹è¯´æ˜

**ä¿®æ”¹æ—¥æœŸ**: 2025-10-28  
**çŠ¶æ€**: âœ… å·²å®Œæˆ

---

## ğŸ“‹ ä¿®æ”¹æ¦‚è¿°

å°†Detectionæ–‡ä»¶å¤¹ä»å¤‡ä»½æ¢å¤åï¼Œæ‰€æœ‰è„šæœ¬ä¸­çš„è·¯å¾„å¼•ç”¨å·²æ›´æ–°ä¸ºä½¿ç”¨Detectionæ–‡ä»¶å¤¹å†…çš„ç›¸å¯¹è·¯å¾„ï¼Œè€ŒéåŸé¡¹ç›®çš„ç»å¯¹è·¯å¾„ã€‚

---

## ğŸ”§ å…·ä½“ä¿®æ”¹

### 1. `scripts/run_inference_final.py`

**ä¿®æ”¹å†…å®¹**:
- âœ… ä¿®æ”¹å¯¼å…¥è¯­å¥ï¼šä» `from scripts.detection.inference_longemotion import` æ”¹ä¸º `from inference_longemotion import`
- âœ… æ›´æ–°æ–‡ä»¶è·¯å¾„ï¼šä½¿ç”¨Detectionæ–‡ä»¶å¤¹å†…çš„ç›¸å¯¹è·¯å¾„
  - æ¨¡å‹è·¯å¾„: `Detection/model/best_model.pt`
  - æµ‹è¯•æ•°æ®: `Detection/test_data/test.jsonl`
  - è¾“å‡ºæ–‡ä»¶: `Detection/submission/predictions.jsonl`
  - è¯¦ç»†ç»“æœ: `Detection/submission/predictions_detailed.json`

**å…³é”®ä»£ç **:
```python
detection_root = Path(__file__).parent.parent
model_path = detection_root / "model" / "best_model.pt"
test_file = detection_root / "test_data" / "test.jsonl"
output_file = detection_root / "submission" / "predictions.jsonl"
output_detailed = detection_root / "submission" / "predictions_detailed.json"
```

### 2. `scripts/inference_longemotion.py`

**ä¿®æ”¹å†…å®¹**:
- âœ… æ›´æ–°é»˜è®¤å‚æ•°è·¯å¾„ï¼Œä½¿ç”¨ç›¸å¯¹äºscriptsæ–‡ä»¶å¤¹çš„è·¯å¾„
  - é»˜è®¤æ¨¡å‹è·¯å¾„: `../model/best_model.pt`
  - é»˜è®¤æµ‹è¯•æ–‡ä»¶: `../test_data/test.jsonl`
  - é»˜è®¤è¾“å‡ºæ–‡ä»¶: `../submission/predictions.jsonl`
  - é»˜è®¤è¯¦ç»†ç»“æœ: `../submission/predictions_detailed.json`

### 3. `scripts/convert_submission_format.py`

**ä¿®æ”¹å†…å®¹**:
- âœ… æ›´æ–°è¾“å…¥è¾“å‡ºæ–‡ä»¶è·¯å¾„
  - è¾“å…¥æ–‡ä»¶: `../submission/predictions.jsonl`
  - è¾“å‡ºæ–‡ä»¶: `../submission/Emotion_Detection_Result.jsonl`

### 4. æ–‡æ¡£æ›´æ–°

#### `README.md`
- âœ… æ›´æ–°ä½¿ç”¨è¯´æ˜ï¼Œå¼ºè°ƒéœ€è¦åœ¨Detectionæ–‡ä»¶å¤¹å†…è¿è¡Œ

#### `å¿«é€Ÿä½¿ç”¨æŒ‡å—.md`
- âœ… æ›´æ–°æ‰€æœ‰è¿è¡Œæ­¥éª¤å’Œå‘½ä»¤
- âœ… æ›´æ–°æ–‡ä»¶è·¯å¾„è¯´æ˜
- âœ… æ·»åŠ æ•…éšœæ’é™¤æŒ‡å—
- âœ… æ›´æ–°æ³¨æ„äº‹é¡¹

---

## ğŸ“ å½“å‰æ–‡ä»¶ç»“æ„

```
Detection/
â”œâ”€â”€ model/
â”‚   â””â”€â”€ best_model.pt              # è®­ç»ƒå¥½çš„æ¨¡å‹
â”‚
â”œâ”€â”€ test_data/
â”‚   â””â”€â”€ test.jsonl                 # æµ‹è¯•é›†æ•°æ®
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ run_inference_final.py     # ä¸»è¿è¡Œè„šæœ¬
â”‚   â”œâ”€â”€ inference_longemotion.py   # æ¨ç†æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ convert_submission_format.py # æ ¼å¼è½¬æ¢è„šæœ¬
â”‚   â””â”€â”€ detection_model.py         # æ¨¡å‹å®šä¹‰
â”‚
â”œâ”€â”€ submission/
â”‚   â””â”€â”€ Emotion_Detection_Result.jsonl # æäº¤æ–‡ä»¶
â”‚
â”œâ”€â”€ reports/
â”‚   â”œâ”€â”€ é¡¹ç›®æœ€ç»ˆè¿›åº¦æŠ¥å‘Š.md
â”‚   â”œâ”€â”€ é¡¹ç›®è‡ªæŸ¥å®Œæ•´æŠ¥å‘Š_20251025.txt
â”‚   â””â”€â”€ é¡¹ç›®è‡ªæŸ¥æŠ¥å‘Š.md
â”‚
â”œâ”€â”€ README.md                      # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ å¿«é€Ÿä½¿ç”¨æŒ‡å—.md                 # ä½¿ç”¨æŒ‡å—
â””â”€â”€ è·¯å¾„ä¿®æ”¹è¯´æ˜.md                 # æœ¬æ–‡æ¡£
```

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•1: ä»Detectionæ–‡ä»¶å¤¹è¿è¡Œï¼ˆæ¨èï¼‰

```bash
# 1. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆåœ¨é¡¹ç›®æ ¹ç›®å½•ï¼‰
.\venv\Scripts\activate

# 2. è¿›å…¥Detectionæ–‡ä»¶å¤¹
cd Detection

# 3. è¿è¡Œæ¨ç†
python scripts/run_inference_final.py
```

### æ–¹æ³•2: ä»scriptsæ–‡ä»¶å¤¹è¿è¡Œ

```bash
# 1. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
.\venv\Scripts\activate

# 2. è¿›å…¥scriptsæ–‡ä»¶å¤¹
cd Detection/scripts

# 3. ç›´æ¥è¿è¡Œï¼ˆä½¿ç”¨é»˜è®¤ç›¸å¯¹è·¯å¾„ï¼‰
python inference_longemotion.py
```

---

## âœ… éªŒè¯ç»“æœ

æ‰€æœ‰å…³é”®æ–‡ä»¶å·²éªŒè¯å­˜åœ¨ï¼š
- âœ… `model/best_model.pt` - æ¨¡å‹æ–‡ä»¶ (~400MB)
- âœ… `test_data/test.jsonl` - æµ‹è¯•é›†ï¼ˆ136ä¸ªæ ·æœ¬ï¼‰
- âœ… `submission/Emotion_Detection_Result.jsonl` - æäº¤æ–‡ä»¶ï¼ˆ136è¡Œï¼‰
- âœ… æ‰€æœ‰è„šæœ¬æ–‡ä»¶å®Œæ•´
- âœ… æ‰€æœ‰æ–‡æ¡£æ–‡ä»¶å®Œæ•´

---

## ğŸ“ é‡è¦æ³¨æ„äº‹é¡¹

1. **è¿è¡Œä½ç½®**: è„šæœ¬å¿…é¡»åœ¨Detectionæ–‡ä»¶å¤¹å†…ï¼ˆæˆ–å…¶å­æ–‡ä»¶å¤¹ï¼‰è¿è¡Œ
2. **ç›¸å¯¹è·¯å¾„**: æ‰€æœ‰è·¯å¾„éƒ½åŸºäºDetectionæ–‡ä»¶å¤¹çš„ç›¸å¯¹è·¯å¾„
3. **è™šæ‹Ÿç¯å¢ƒ**: è¿è¡Œå‰è¯·ç¡®ä¿æ¿€æ´»é¡¹ç›®çš„è™šæ‹Ÿç¯å¢ƒ
4. **æ–‡ä»¶å®Œæ•´æ€§**: è¯·å‹¿ç§»åŠ¨æˆ–åˆ é™¤modelæ–‡ä»¶å¤¹ä¸­çš„best_model.pt

---

## ğŸ”„ ä¸åŸé¡¹ç›®çš„åŒºåˆ«

| åŸè·¯å¾„ | æ–°è·¯å¾„ | è¯´æ˜ |
|--------|--------|------|
| `checkpoints/detection/best_model.pt` | `Detection/model/best_model.pt` | æ¨¡å‹ä½ç½® |
| `data/detection/test/test.jsonl` | `Detection/test_data/test.jsonl` | æµ‹è¯•æ•°æ® |
| `evaluation/detection/test_results/` | `Detection/submission/` | è¾“å‡ºç›®å½• |

---

## ğŸ› å¸¸è§é—®é¢˜

### Q: è¿è¡Œè„šæœ¬æ—¶æ‰¾ä¸åˆ°æ–‡ä»¶ï¼Ÿ
**A**: ç¡®ä¿åœ¨Detectionæ–‡ä»¶å¤¹å†…è¿è¡Œï¼Œä½¿ç”¨ `cd Detection` è¿›å…¥æ–‡ä»¶å¤¹ã€‚

### Q: æ¨¡å‹åŠ è½½å¤±è´¥ï¼Ÿ
**A**: æ£€æŸ¥ `model/best_model.pt` æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¤§å°çº¦400MBã€‚

### Q: å¯¼å…¥æ¨¡å—å¤±è´¥ï¼Ÿ
**A**: ç¡®ä¿è™šæ‹Ÿç¯å¢ƒå·²æ¿€æ´»ï¼Œå¹¶å·²å®‰è£…æ‰€éœ€ä¾èµ–ï¼š
```bash
pip install torch transformers tqdm
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- `å¿«é€Ÿä½¿ç”¨æŒ‡å—.md` - è¯¦ç»†ä½¿ç”¨è¯´æ˜
- `reports/é¡¹ç›®æœ€ç»ˆè¿›åº¦æŠ¥å‘Š.md` - å®Œæ•´æŠ€æœ¯æŠ¥å‘Š
- `README.md` - é¡¹ç›®æ¦‚è§ˆ

---

**ä¿®æ”¹å®Œæˆï¼æ‰€æœ‰è·¯å¾„å·²æ­£ç¡®é…ç½®ã€‚** âœ…

